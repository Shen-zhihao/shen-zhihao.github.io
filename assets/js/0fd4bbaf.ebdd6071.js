"use strict";(self.webpackChunkweb_study=self.webpackChunkweb_study||[]).push([[465],{3905:(e,n,t)=>{t.d(n,{Zo:()=>i,kt:()=>m});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),c=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},i=function(e){var n=c(e.components);return r.createElement(p.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},h=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,p=e.parentName,i=l(e,["components","mdxType","originalType","parentName"]),u=c(t),h=a,m=u["".concat(p,".").concat(h)]||u[h]||d[h]||s;return t?r.createElement(m,o(o({ref:n},i),{},{components:t})):r.createElement(m,o({ref:n},i))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,o=new Array(s);o[0]=h;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var c=2;c<s;c++)o[c]=t[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}h.displayName="MDXCreateElement"},2282:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var r=t(7462),a=(t(7294),t(3905));const s={},o=void 0,l={unversionedId:"NodeSidebar/NodeJs\u57fa\u7840",id:"NodeSidebar/NodeJs\u57fa\u7840",title:"NodeJs\u57fa\u7840",description:"HTTP \u6a21\u5757",source:"@site/docs/NodeSidebar/NodeJs\u57fa\u7840.md",sourceDirName:"NodeSidebar",slug:"/NodeSidebar/NodeJs\u57fa\u7840",permalink:"/docs/NodeSidebar/NodeJs\u57fa\u7840",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"NodeSidebar"},p={},c=[{value:"HTTP \u6a21\u5757",id:"http-\u6a21\u5757-1",level:5},{value:"jsonp \u8de8\u57df",id:"jsonp-\u8de8\u57df",level:5},{value:"cors \u5934\u8de8\u57df",id:"cors-\u5934\u8de8\u57df",level:5},{value:"parse \u6a21\u5757",id:"parse-\u6a21\u5757",level:5},{value:"format \u6a21\u5757",id:"format-\u6a21\u5757",level:5},{value:"resolve \u6a21\u5757",id:"resolve-\u6a21\u5757",level:5},{value:"\u65b0 url \u6a21\u5757",id:"\u65b0-url-\u6a21\u5757",level:5},{value:"cheerio \u6a21\u5757",id:"cheerio-\u6a21\u5757",level:5},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:5},{value:"\u5904\u7406\u6570\u636e",id:"\u5904\u7406\u6570\u636e",level:5},{value:"\u642d\u5efa\u9759\u6001 web \u670d\u52a1",id:"\u642d\u5efa\u9759\u6001-web-\u670d\u52a1",level:5},{value:"api \u670d\u52a1",id:"api-\u670d\u52a1",level:5},{value:"use \u4e2d\u95f4\u4ef6",id:"use-\u4e2d\u95f4\u4ef6",level:5},{value:"request \u6a21\u5757-\u5b9e\u73b0\u8de8\u6e90\u8bf7\u6c42\uff08\u4ee3\u7406\uff09",id:"request-\u6a21\u5757-\u5b9e\u73b0\u8de8\u6e90\u8bf7\u6c42\u4ee3\u7406",level:5}],i={toc:c},u="wrapper";function d(e){let{components:n,...t}=e;return(0,a.kt)(u,(0,r.Z)({},i,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("a",{name:"N68Mn"}),(0,a.kt)("h1",{id:"\u6a21\u5757\u5316\u89c4\u8303"},"\u6a21\u5757\u5316\u89c4\u8303"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"nodejs\u4f7f\u7528\u7684\u6a21\u5757\u5316\u89c4\u8303 \u53eb\u505a common.js \u89c4\u8303:\n\u6bcf\u4e00\u4e2a\u6a21\u5757\u90fd\u6709\u72ec\u7acb\u7684\u4f5c\u7528\u57df \u4ee3\u7801\u5728\u5404\u81ea\u6a21\u5757\u4e2d\u6267\u884c \u4e0d\u4f1a\u9020\u6210\u5168\u5c40\u6c61\u67d3\n\u6bcf\u4e00\u4e2a\u6a21\u5757\u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u6587\u4ef6\uff08module\u5bf9\u8c61\uff09\n\u6a21\u5757\u53ef\u4ee5\u88ab\u591a\u6b21\u52a0\u8f7d\uff08module.exports \u5c5e\u6027\uff09 \u4f46\u662f\u4ec5\u5728\u7b2c\u4e00\u6b21\u52a0\u8f7d\u65f6\u6267\u884c\u4e00\u6b21\n\u8fd0\u884c\u7ed3\u679c\u4f1a\u88ab\u7f13\u5b58 \u5982\u679c\u518d\u6b21\u52a0\u8f7d\u4f1a\u4ece\u7f13\u5b58\u4e2d\u83b7\u5f97\u7ed3\u679c\n\u6a21\u5757\u7684\u52a0\u8f7d\u987a\u5e8f\u548c\u4ee3\u7801\u7684\u4e66\u5199\u987a\u5e8f\u6709\u5173\n\n// exports\u5bf9\u8c61\u662fmodule\u5bf9\u8c61\u7684\u5c5e\u6027\uff0c\u5305\u542b\u5bfc\u51fa\u7684\u4fe1\u606f\n\u5bfc\u51fa\uff1amodule.exports ={}     // module.exports.a = a || exports.a = a;\u9ed8\u8ba4\u6307\u5411\u4ee5module.exports\u4e3a\u51c6\n\u5bfc\u5165\uff1acount a = require('');  //\u53ea\u6709\u81ea\u5b9a\u4e49\u6a21\u5757\u9700\u8981\u5199\u8def\u5f84('./index')\uff0c\u5bfc\u5165\u5bf9\u8c61\u6c38\u8fdc\u662fmodule.exports\u6307\u5411\u7684\u5bf9\u8c61\n")),(0,a.kt)("a",{name:"KkRRy"}),(0,a.kt)("h1",{id:"http-\u6a21\u5757"},"HTTP \u6a21\u5757"),(0,a.kt)("a",{name:"O35fh"}),(0,a.kt)("h5",{id:"http-\u6a21\u5757-1"},"HTTP \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'//\u5bfc\u5165\u6a21\u5757\nconst http = require("http");\nconst https = require("https");\n\n//\u521b\u5efa\u670d\u52a1\nlet server = http.createServer((req, res) => {\n  // request\uff1a\u89e3\u6790\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\n  //\u5e38\u7528\u5c5e\u6027\u53ca\u65b9\u6cd5\uff1aurl\uff08\u8bf7\u6c42\u8def\u5f84\uff09 method\uff08\u8bf7\u6c42\u65b9\u6cd5\uff09headers\uff08\u5934\u90e8\uff09\n  //url\uff1a\u8bf7\u6c42\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u6839\u636eURL\u8bbe\u7f6e\u51fa\u8def\u7531\u6a21\u5f0f\uff0cexpress\u7684\u5c31\u662f\u57fa\u4e8e\u6b64\u8bbe\u7f6e\u7684\n  //methoe\uff1a\u8bf7\u6c42\u7684\u65b9\u5f0f\u5206\u4e3a\uff0cpost get delete put patch\n  //headers: \u8bf7\u6c42\u7684\u5934\u90e8\uff0c\u5ba2\u6237\u5355\u7684cookie\uff0c\u6570\u636e\u4f20\u8f93\u7684\u7c7b\u578b\u7b49\u90fd\u653e\u5728header\u4e2d\n  //data\u4e8b\u4ef6\uff1acreateServer\u60f3\u8981\u83b7\u53d6\u8bf7\u6c42\u6570\u636e\u4f53\u9700\u8981\u76d1\u542cdata\u4e8b\u4ef6\n\n  //response\uff1a\u76f8\u5e94\u5ba2\u6237\u7aef\u8bf7\u6c42\uff0c\u5e38\u7528\u5c5e\u6027\u53ca\u65b9\u6cd5\u5982\u4e0b\uff1a\n  //end\uff1ares.end()\n  //setHeader(name,content)\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u5355\u4e2aheader\u5c5e\u6027\uff0c\u53ef\u4ee5\u591a\u6b21\u8bbe\u7f6e\n  //destory\uff1a\u53d6\u6d88\u8fd4\u56de\n  //statusCode\uff1a\u8bbe\u7f6e\u8fd4\u56de\u7684\u72b6\u6001\u7801\uff0c\u5982200 404 400 500\u7b49\n  //statusMessage\uff1a\u8bbe\u7f6e\u72b6\u6001\u7801\u5bf9\u5e94\u8fd4\u56de\u7684\u4fe1\u606f\n  //writeHead\uff1a\u53ef\u4ee5\u540c\u65f6\u8bbe\u7f6estatusCode statusMessage \u548c\u591a\u4e2aheader\u5c5e\u6027\n\n  res.writeHead(200, { "content-type": "text/html;charset=utf-8" });\n  let data = ""; // \u8fd4\u56de\u6570\u636e\n\n  // \u6839\u636e\u4e0d\u540c\u7684\u8bf7\u6c42\u7c7b\u578b \u8bbe\u7f6e\u4e0d\u540c\u7684\u54cd\u5e94\u5934\n  switch (req.method) {\n    case "GET":\n      // data\u4e8b\u4ef6\u6d41 \u63a5\u6536\u5230\u6570\u636e\u65f6\u89e6\u53d1\u7684\u4e8b\u4ef6 \u53c2\u6570 chunk \u6570\u636e\u5757\uff0c\u5728\u51fd\u6570\u5185\u662f\u5c06\u6570\u636e\u5757\u62fc\u63a5\u7ed9data\n      https.get("www.baidu.com", (res) => {\n        res.on("data", (chunk) => (data += chunk));\n        // end\u4e8b\u4ef6 \u5728\u6570\u636e\u54cd\u5e94\u7ed3\u675f\u65f6\u89e6\u53d1\n        res.on("end", () => {\n          data = querystring.parse(data);\n          // \u63a5\u53e3\u8def\u7531\u8bbe\u7f6e (\u540e\u7aef\u6570\u636e\u63a5\u53e3)\n          switch (req.url) {\n            case "/users":\n              console.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f");\n              break;\n            case "/addUser":\n              // \u5c06\u6570\u636e\u5199\u5165\u6570\u636e\u5e93\n              data.add = true;\n              res.end(JSON.stringify(data));\n              break;\n            case "/weather":\n              weather(res);\n          }\n        });\n      });\n      break;\n    case "POST":\n      const options = {\n        hostname: "",\n        port: "443",\n        path: "",\n        method: "POST",\n        headers: {\n          "content-type": "application/json",\n        },\n      };\n      https.request(options, (res) => {\n        res.on("data", (chunk) => (data += chunk));\n        // end\u4e8b\u4ef6 \u5728\u6570\u636e\u54cd\u5e94\u7ed3\u675f\u65f6\u89e6\u53d1\n        res.on("end", () => {\n          data = querystring.parse(data);\n          console.log(daat);\n        });\n      });\n      req.write(JSON.stringify({ name: "", age: "" })); // \u53d1\u9001\u7684\u8bf7\u6c42\u6570\u636e\n      req.end();\n      break;\n    default:\n  }\n});\n//\u76d1\u542c3000\u7aef\u53e3\uff0c\u5f00\u542f\u670d\u52a1\nserver.listen(3000, () => {\n  console.log("\u6253\u5f00\u4e863000\u7aef\u53e3");\n});\n')),(0,a.kt)("a",{name:"iT6vp"}),(0,a.kt)("h5",{id:"jsonp-\u8de8\u57df"},"jsonp \u8de8\u57df"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const http = require("http");\nconst url = require("url");\n\n//\u521b\u5efa\u670d\u52a1\nhttp\n  .createServer((req, res) => {\n    res.writeHead(200, { "content-type": "text/html;charset=utf-8" });\n    if (req.url === "/favicon.ico") return;\n    const urlObj = url.parse(req.url, true);\n    res.end(\n      `${urlObj.query.callback}(${JSON.stringify({\n        name: "xiaoming",\n        age: 18,\n      })})`\n    ); // \u8fd4\u56de\u4e00\u4e2a\u51fd\u6570 fn( ${urlObj.query.callback} ) \u4e0e\u524d\u7aef\u5b9a\u4e49\u7684 fn \u540d\u79f0\u4e00\u81f4\n  })\n  .listen(3000, () => {\n    console.log("\u6253\u5f00\u4e863000\u7aef\u53e3");\n  });\n')),(0,a.kt)("a",{name:"y6yMo"}),(0,a.kt)("h5",{id:"cors-\u5934\u8de8\u57df"},"cors \u5934\u8de8\u57df"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const http = require("http");\n\n//\u521b\u5efa\u670d\u52a1\nhttp\n  .createServer((req, res) => {\n    res.writeHead(200, {\n      "content-type": "application/json;charset=utf-8",\n      "access-control-allow-origin": "*", // \u8de8\u57df\n    });\n\n    res.end(\n      JSON.stringify({\n        name: "xiaoming",\n        age: 18,\n      })\n    ); // \u8fd4\u56de\u4e00\u4e2a\u51fd\u6570 fn( ${urlObj.query.callback} ) \u4e0e\u524d\u7aef\u5b9a\u4e49\u7684 fn \u540d\u79f0\u4e00\u81f4\n  })\n  .listen(3000, () => {\n    console.log("\u6253\u5f00\u4e863000\u7aef\u53e3");\n  });\n')),(0,a.kt)("a",{name:"qiZ0D"}),(0,a.kt)("h1",{id:"url-\u6a21\u5757"},"URL \u6a21\u5757"),(0,a.kt)("a",{name:"ouarV"}),(0,a.kt)("h5",{id:"parse-\u6a21\u5757"},"parse \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const http = require(\"http\");\nconst url = require(\"url\");\n\n//\u521b\u5efa\u670d\u52a1\nlet server = http.createServer((req, res) => {\n  res.writeHead(200, { \"content-type\": \"text/html;charset=utf-8\" });\n  if (req.url === \"/favicon.ico\") return;\n  console.log(url.parse(req.url, true)); // \u63a5\u6536\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u4e3atrue\u5219\u8f6c\u5316query\u5bf9\u8c61\n  // =Url {\n  //   protocol: null,\n  //   slashes: null,\n  //   auth: null,\n  //   host: null,\n  //   port: null,\n  //   hostname: null,\n  //   hash: null,\n  //   search: '?user=b&age=18',\n  //   query: [Object: null prototype] { user: 'b', age: '18' },\n  //   pathname: '/api',\n  //   path: '/api?user=b&age=18',\n  //   href: '/api?user=b&age=18'\n  // }\n  res.end();\n});\n//\u76d1\u542c3000\u7aef\u53e3\uff0c\u5f00\u542f\u670d\u52a1\nserver.listen(3000, () => {\n  console.log(\"\u6253\u5f00\u4e863000\u7aef\u53e3\");\n});\n")),(0,a.kt)("a",{name:"TmDjP"}),(0,a.kt)("h5",{id:"format-\u6a21\u5757"},"format \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const url = require(\"url\");\nconst urlObj= {\n    protocol: 'https',\n    slashes: true,\n    auth: null,\n    host: 'www.baidu.com:443',\n    port: 443,\n    hostname: 'www.baidu.com',\n    hash: '#tag=110',\n    search: '?user=b&age=18',\n    query: { user: 'b', age: '18' },\n    pathname: '/api',\n    path: '/api?user=b&age=18',\n  }\nurl.format(urlObj)   =>  https://www.baidu.com:443/api?user=b&age=18#tag=110\n")),(0,a.kt)("a",{name:"Oa1AW"}),(0,a.kt)("h5",{id:"resolve-\u6a21\u5757"},"resolve \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"url.resolve('/one/two','three')   => '/one/three'\nurl.resolve('/one/two/','three')   => '/one/two/three'\nurl.resolve('http://www.baidu.com/a/b/c','d')   => 'http://www.baidu.com/d'\n")),(0,a.kt)("a",{name:"NGg6u"}),(0,a.kt)("h5",{id:"\u65b0-url-\u6a21\u5757"},"\u65b0 url \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"const http = require(\"http\");\n\nlet server = http.createServer((req, res) => {\n  res.writeHead(200, { \"content-type\": \"text/html;charset=utf-8\" });\n  if (req.url === \"/favicon.ico\") return;\n  const newUrl = new URL(req.url, \"http://localhost:3000\");\n  console.log(newUrl);\n\n  // URL {\n  //   href: 'http://localhost:3000/api?user=b&age=18',\n  //   origin: 'http://localhost:3000',\n  //   protocol: 'http:',\n  //   username: '',\n  //   password: '',\n  //   host: 'localhost:3000',\n  //   hostname: 'localhost',\n  //   port: '3000',\n  //   pathname: '/api',\n  //   search: '?user=b&age=18',\n  //   searchParams: URLSearchParams { 'user' => 'b', 'age' => '18' }, // \u53ef\u8fed\u4ee3\u5bf9\u8c61\n  //   hash: ''\n  // }\n\n  res.end();\n});\n\nserver.listen(3000, () => {\n  console.log(\"\u6253\u5f00\u4e863000\u7aef\u53e3\");\n});\n")),(0,a.kt)("a",{name:"nLuC6"}),(0,a.kt)("h1",{id:"querystring-\u6a21\u5757"},"querystring \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const queryatring = require("querystring");\n\nconst str = "name=abc&age=18&location=shanghai";\nconst obj = {\n  name: "abc",\n  age: "18",\n  location: "shanghai",\n};\n\n// \u5c06query\u683c\u5f0f\u8f6c\u6210\u5bf9\u8c61\nquerystring.parse(str);\n// => [Object: null prototype] {\n//   name: \'abc\',\n//   age: \'18\',\n//   location: \'shanghai\'\n// }\n\n// \u5c06\u5bf9\u8c61\u8f6c\u6210query\u683c\u5f0f\u5b57\u7b26\u4e32\nquerystring.stringify(obj);\n// => "name=abc&age=18&location=shanghai"\n')),(0,a.kt)("a",{name:"aLvdC"}),(0,a.kt)("h1",{id:"\u722c\u866b\u6a21\u5757"},"\u722c\u866b\u6a21\u5757"),(0,a.kt)("a",{name:"D8Url"}),(0,a.kt)("h5",{id:"cheerio-\u6a21\u5757"},"cheerio \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"cheerio\u6a21\u5757\u4e3aNode.js \u722c\u866b\u7b2c\u4e09\u65b9\u6a21\u5757\uff0c\u5185\u7f6ejq\u57fa\u672c\u64cd\u4f5c // npm i cheerio\n//\u52a0\u8f7d\u6570\u636e(\u7f51\u9875)\uff0c\u8fdb\u884c\u5143\u7d20\u64cd\u4f5c\nlet $ = cheerio.load(rawData);\n")),(0,a.kt)("a",{name:"rrxqn"}),(0,a.kt)("h1",{id:"path-\u6a21\u5757"},"path \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"console.log(__dirname); // \u5f53\u524d\u76ee\u5f55 \u7edd\u5bf9\u8def\u5f84\nconsole.log(__filename); // \u5f53\u524d\u6587\u4ef6 \u7edd\u5bf9\u8def\u5f84\n\u62fc\u63a5\u8def\u5f84\uff1a\npath.join(path):\n    path.join('__dirname,'a','b');       //\u62fc\u63a5\u5f53\u524d\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84\n\u83b7\u5f97\u6587\u4ef6\u540e\u7f00\uff1a\npath.extname(path)\n\u83b7\u5f97\u8def\u5f84\u540d\uff1a\npath.dirname(path)\n")),(0,a.kt)("a",{name:"mcP7V"}),(0,a.kt)("h1",{id:"event-\u6a21\u5757"},"event \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'//\u5bfc\u5165\u6a21\u5757\nconst EventEmitter = require("events");\n\nconst event = new EventEmitter();\n\nevent.on("start", (data) => {\n  console.log("\u89e6\u53d1\u4e86");\n  console.log(data);\n});\n\nsetTimeout(() => {\n  event.emit("start", "\u5f00\u59cb");\n}, 2000);\n')),(0,a.kt)("a",{name:"DERuB"}),(0,a.kt)("h1",{id:"fs-\u6a21\u5757"},"fs \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"//\u5bfc\u5165\u6a21\u5757\ncount fs = require('fs');\n//\u8bfb\u53d6\u6587\u4ef6\nfs.readFile(url,'utf8',(err,data)=>{\n    if (err) throw err;\n})\n//\u5199\u5165\u6587\u4ef6\nfs.writeFile(file,data[,options],callback)\n//\u6587\u4ef6\u8ffd\u52a0\nfs.appendFile(file,data[,options],callback)\n//\u4fee\u6539\u6587\u4ef6\u540d\nfs.rename(oldpath,newpath,callback)\n//\u8bfb\u53d6\u76ee\u5f55\nfs.readdir(path[,option],callback(err,files))\n")),(0,a.kt)("a",{name:"BObrG"}),(0,a.kt)("h1",{id:"mysql-\u6a21\u5757"},"mysql \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"\u8fde\u63a5\u6c60\u6587\u4ef6\uff1a\nconst mysql = require('mysql');\nvar pool = mysql.createPool({ //  \u521b\u5efa\u8fde\u63a5\u6c60\n    connectionLimit: 10,\n    host: 'localhost',\n    user: 'root',\n    password: 'root',\n    database: 'h5_2013'\n});\nmodule.exports = pool;        //\u5bfc\u51fa\u6a21\u5757\n\n\u6587\u4ef62\uff1a\nconst mysql = require('pool');   //\u5f15\u5165\u5bfc\u51fa\u7684\u914d\u7f6e\n\u6267\u884csql\u8bed\u53e5\uff1a\n mysql.query('select * from users', (err, data) =>\n{ // \u67e5\u6570\u636e\n            if (err) console.log(err);\n            res.send(data); // \u53d1\u9001\u67e5\u8be2\u5230\u7684\u6570\u636e\n});\n")),(0,a.kt)("a",{name:"Htsy6"}),(0,a.kt)("h1",{id:"jwt-\u6a21\u5757"},"jwt \u6a21\u5757"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"token \u4ee4\u724c\n\u5b83\u662f\u4e00\u4e2a\u4e09\u6bb5\u5f0f\u7684\u52a0\u5bc6\u5b57\u7b26\u4e32\nxxxxxxxxxx.yyyyyyyyyyyyyyyy.zzzzzzz\n\u7b2c\u4e00\u6bb5: \u5934\u4fe1\u606f \u7b7e\u8bc1:\u5b89\u5168\u4fe1\u606f\u9a8c\u8bc1 \u53e3\u4ee4 \u4f7f\u7528\u4e0d\u53ef\u9006\u7684\u54c8\u5e0c\u7b97\u6cd5\u8fdb\u884c\u52a0\u5bc6\n\u7b2c\u4e8c\u6bb5: \u4f60\u9700\u8981\u5b58\u50a8\u7684\u4fe1\u606f  \u91c7\u7528base64 \u53ef\u9006\u52a0\u5bc6 \u622a\u53d6\u4e00\u90e8\u5206\n\u7b2c\u4e09\u6bb5: \u989d\u5916\u4fe1\u606f \u4f7f\u7528\u4e0d\u53ef\u9006\u54c8\u5e0c\u7b97\u6cd5\u8fdb\u884c\u52a0\u5bc6\n\u6d4f\u89c8\u5668\u5728\u53d1\u9001\u8bf7\u6c42\u8fdb\u884c\u767b\u9646\u65f6\n\u670d\u52a1\u5668\u9a8c\u8bc1\u5b8c\u4fe1\u606f \u4fe1\u606f\u6b63\u786e \u5219\u751f\u4ea7\u4e00\u4e2a token\n\u670d\u52a1\u5668\u5c06\u8fd9\u4e2atoken\u53d1\u9001\u7ed9\u524d\u7aef \u524d\u7aef\u8fdb\u884c\u5b58\u50a8\n\u5982\u679c\u524d\u7aef\u8bf7\u6c42\u4e86\u9700\u8981\u9a8c\u8bc1\u767b\u5f55\u6743\u9650\u7684\u9875\u9762\u6216\u6570\u636e \u524d\u7aef\u5c06token\u8ddf\u968f\u8bf7\u6c42\u53d1\u56de\u540e\u7aef\n\u540e\u7aef\u901a\u8fc7\u89e3\u5bc6 \u9a8c\u8bc1token\u7684\u6709\u6548\u6027\n\nconst jwt = require('jsonwebtoken');\n\n// \u751f\u6210 token\uff1a\n// jwt.sign(\u5b58\u50a8\u7684\u6570\u636e,\u53e3\u4ee4,\u53c2\u6570);\n// \u53e3\u4ee4 \u662f\u4e00\u4e2a\u9a8c\u8bc1\u9700\u8981\u7684 \u989d\u5916\u5b57\u7b26\u4e32\n// \u89e3\u7801token\u7684\u65f6\u5019 \u5982\u679c\u53e3\u4ee4\u4e0d\u540c\u5c31\u65e0\u6cd5\u6b63\u786e\u89e3\u7801\n\n// \u89e3\u7801token\uff1a\n// jwt.verify(token,\u53e3\u4ee4,\u56de\u8c03);\n\nlet userInfo = {\n    username: 'zhangsan',\n    age: 25,\n    sex: 'nan',\n    phone: 13688888888\n};\n\n// \u751f\u6210token\nlet token = jwt.sign(userInfo, 'rootbk', { expiresIn: 60 });        //expiresIn \u8fc7\u671f\u65f6\u95f4\n\n// console.log(token);\n\n// \u89e3\u7801token\njwt.verify(token, 'rootbk', (err, data) => {\n    if (err) console.log(err.message);\n    console.log(data);\n})\n")),(0,a.kt)("a",{name:"Js2Ji"}),(0,a.kt)("h1",{id:"\u9879\u76ee\u811a\u624b\u67b6-express"},"\u9879\u76ee\u811a\u624b\u67b6 express"),(0,a.kt)("a",{name:"cOEFf"}),(0,a.kt)("h5",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"#\u4f60\u53ef\u4ee5\u901a\u8fc7 npx \uff08\u5305\u542b\u5728 Node.js 8.2.0 \u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff09\u547d\u4ee4\u6765\u8fd0\u884c Express \u5e94\u7528\u7a0b\u5e8f\u751f\u6210\u5668\u3002\n$ npx express-generator\n#\u5bf9\u4e8e\u8f83\u8001\u7684 Node \u7248\u672c\uff0c\u8bf7\u901a\u8fc7 npm \u5c06 Express \u5e94\u7528\u7a0b\u5e8f\u751f\u6210\u5668\u5b89\u88c5\u5230\u5168\u5c40\u73af\u5883\u4e2d\u5e76\u6267\u884c\u5373\u53ef\u3002\n$ npm install -g express-generator\n$ express name\n#\u7136\u540e\u5b89\u88c5\u6240\u6709\u4f9d\u8d56\u5305\uff1a\n$ cd myapp\n$ npm install\n#\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00 http://localhost:3000/ \u7f51\u5740\u5c31\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u5e94\u7528\u4e86\uff0c\u901a\u8fc7\u751f\u6210\u5668\u521b\u5efa\u7684\u5e94\u7528\u4e00\u822c\u90fd\u6709\u5982\u4e0b\u76ee\u5f55\u7ed3\u6784\uff1a\n\n- \u9879\u76ee\u540d\n    - [bin]       # \u5b58\u653e\u53ef\u6267\u884c\u7a0b\u5e8f\n        - www     # \u5f00\u542fhttp\u670d\u52a1\n    - [public]    # \u5b58\u653e\u9759\u6001\u524d\u7aef\u6587\u4ef6\n        - [images]\n        - [javascripts]\n        - [stylesheet]\n    - [routes]    # \u5b58\u653e\u8def\u7531\u6587\u4ef6\n        - index.js\n        - users.js\n    - [views]     # \u524d\u7aef\u89c6\u56fe\u6a21\u677f\n        - error.ejs\n        - index.ejs\n    - app.js      # \u4e3b\u7a0b\u5e8f\n    - package.json   # \u4f9d\u8d56\u4fe1\u606f\n")),(0,a.kt)("a",{name:"tGQoV"}),(0,a.kt)("h5",{id:"\u5904\u7406\u6570\u636e"},"\u5904\u7406\u6570\u636e"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"app.use(express.json());\napp.use(express.urlencoded({ extended: true }));\n")),(0,a.kt)("a",{name:"vPtw7"}),(0,a.kt)("h5",{id:"\u642d\u5efa\u9759\u6001-web-\u670d\u52a1"},"\u642d\u5efa\u9759\u6001 web \u670d\u52a1"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const express = require("express"); // \u5f15\u5165\u7b2c\u4e09\u65b9\u6a21\u5757\u7684\u65b9\u5f0f\u548c\u5f15\u5165\u5185\u7f6e\u6a21\u5757\u7684\u65b9\u5f0f\u76f8\u540c\nconst path = require("path");\nconst app = express(); // \u521b\u5efa\u4e00\u4e2aexpress\u5e94\u7528\nconst conf = {\n  port: 8888,\n  host: "10.31.168.73",\n};\n// \u4f7f\u7528express\u642d\u5efa\u4e00\u4e2a\u9759\u6001\u7684web\u670d\u52a1\u5668\n\n// \u9759\u6001\u670d\u52a1\u5668 \u4f7f\u7528\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u5b9e\u73b0\n// \u5c06public\u76ee\u5f55 \u8bbe\u7f6e\u6210\u9759\u6001\u7684web\u76ee\u5f55\n// public\u4e2d\u6240\u6709\u5185\u5bb9\u90fd\u53ef\u4ee5\u5728web\u670d\u52a1\u4e2d\u88ab\u8bbf\u95ee\n\n// app.use()  \u4f7f\u7528\u4e2d\u95f4\u4ef6\napp.use(express.static(path.join(__dirname, "public"))); // \u9759\u6001\u670d\u52a1\n\napp.listen(conf.port, conf.host, () => {\n  // \u76d1\u542c\u7aef\u53e3\u542f\u52a8\u670d\u52a1\n  console.log(`server is running at http://${conf.host}:${conf.port}`);\n});\n')),(0,a.kt)("a",{name:"P83vL"}),(0,a.kt)("h5",{id:"api-\u670d\u52a1"},"api \u670d\u52a1"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'// \u642d\u5efa\u4e00\u4e2aapi \u670d\u52a1    \u5e94\u7528\u7a0b\u5e8f\u63a5\u53e3\n// express\u53ef\u4ee5\u5feb\u901f\u642d\u5efaapi\u670d\u52a1\n// \u63a5\u53e3\u7684\u4f5c\u7528\u662f\u7ed9\u524d\u7aef\u63d0\u4f9b\u6570\u636e\u652f\u6301(CRUD)\n// \u524d\u7aef\u5982\u4f55\u53d1\u9001\u8bf7\u6c42\n// ajax    get/post\n// href    get\n// form    get/post\n// jsonp   get\n\nconst express = require("express");\nconst app = express(); // \u521b\u5efa\u4e00\u4e2aexpress\u5e94\u7528\nconst conf = {\n  port: 8088,\n  host: "localhost",\n};\n\n// app.get(url,callback);   \u7528\u4e8e\u63a5\u53d7get\u8bf7\u6c42\n// \u53c2\u6570\n// url[string] \u8bf7\u6c42\u8def\u5f84\n// callback[function] \u56de\u8c03\u51fd\u6570\n//    \u56de\u8c03\u53c2\u6570\n//    req      request\n//    res      response\n//    next     \u51fd\u6570 \u4ea4\u51fa\u4e2d\u95f4\u7684\u63a7\u5236\u6743 \u5c06\u8fd9\u4e2a\u8bf7\u6c42\u4ea4\u7ed9\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\n\napp.get("/getItem", (req, res, next) => {\n  console.log("\u6211\u6536\u5230\u4e86\u4e00\u4e2a\u8bf7\u6c42");\n  // \u54cd\u5e94\u5185\u5bb9\n  // res.send() \u53d1\u9001\u6570\u636e \u63a5\u53d7\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53c2\u6570 \u53d1\u9001\u6570\u636e\u540e\u81ea\u52a8\u7ec8\u6b62\u8bf7\u6c42\n  // res.send(\'hahaha\');\n  // res.send({ username: \'zhangsan\', age: 20 });\n\n  // res.json() \u53d1\u9001\u6570\u636e \u63a5\u53d7\u4e00\u4e2aJSON \u53d1\u9001\u540e\u81ea\u52a8\u7ec8\u6b62\u8bf7\u6c42\n  res.json({ data: { username: "zhangsan", age: 20 }, status: success });\n});\napp.get("/getuser", (req, res, next) => {\n  res.json({ username: "lisi", age: 20, success: 1 });\n});\napp.post("/getuser", (req, res, next) => {\n  res.json({ username: "xiaoming", age: 20, success: 1 });\n});\napp.listen(conf.port, conf.host, () => {\n  console.log(`server is running at http://${conf.host}:${conf.port}`);\n});\n')),(0,a.kt)("a",{name:"cs5zD"}),(0,a.kt)("h5",{id:"use-\u4e2d\u95f4\u4ef6"},"use \u4e2d\u95f4\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const express = require("express");\nconst path = require("path");\nconst app = express();\nconst conf = {\n  port: 8888,\n  host: "localhost",\n};\n// \u914d\u7f6e\u9759\u6001web\u670d\u52a1\u5668\napp.use(express.static(path.join(__dirname, "public")));\n\n// express \u5c01\u88c5\u7684\u662f http \u670d\u52a1\u5668\n// express \u63a5\u53d7\u5230\u524d\u7aef\u53d1\u9001\u8fc7\u6765\u7684\u8bf7\u6c42 \u4f1a\u4ea4\u7ed9 \u4e2d\u95f4\u4ef6 \u4f9d\u6b21\u5904\u7406\n\n// \u5f53\u524d\u56de\u8c03\u51fd\u6570\u5c31\u662f\u6211\u7684\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\napp.use((req, res, next) => {\n  console.log("\u6211\u662f\u4e2d\u95f4\u4ef6\u4e00\u53f7");\n\n  // \u5982\u679c\u5728\u4e2d\u95f4\u4e2d\u6ca1\u6709\u4f7f\u7528 send \u6216 json \u7ed3\u675f\u8bf7\u6c42\n  // \u8fd9\u4e2a\u8bf7\u6c42\u4f1a\u88ab\u8ba4\u4e3a\u6ca1\u6709\u5b8c\u6210 \u8fdb\u7a0b\u5c06\u88ab\u6302\u8d77\n  // next \u8c03\u7528next\u53ef\u4ee5\u5c06\u4e2d\u95f4\u4ef6\u7684\u63a7\u5236\u6743\u4ea4\u51fa\n  // \u5c06\u8fd9\u4e2a\u8bf7\u6c42\u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\n  next();\n  // res.send(\'hahah\');\n});\napp.use((req, res, next) => {\n  console.log("\u6211\u662f\u4e2d\u95f4\u4ef6\u4e8c\u53f7");\n  next();\n});\napp.listen(conf.port, conf.host, () => {\n  console.log(`server is running at http://${conf.host}:${conf.port}`);\n});\n')),(0,a.kt)("a",{name:"CWCJq"}),(0,a.kt)("h5",{id:"request-\u6a21\u5757-\u5b9e\u73b0\u8de8\u6e90\u8bf7\u6c42\u4ee3\u7406"},"request \u6a21\u5757-\u5b9e\u73b0\u8de8\u6e90\u8bf7\u6c42\uff08\u4ee3\u7406\uff09"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},'const express = require("express");\nconst request = require("request");\nconst querystring = require("querystring");\nconst app = express();\nlet requestUrl = "http://api.k780.com/?";\nlet props = {\n  app: "weather.future",\n  cityNm: "\u676d\u5dde",\n  appkey: "38926",\n  sign: "f8b4121c2d581be2623569b24f798dee",\n  format: "json",\n};\nrequestUrl += querystring.stringify(props);\napp.get("/api", (req, res, next) => {\n  request(requestUrl, (err, response, body) => {\n    if (err) console.log(err);\n    res.send(body);\n  });\n});\napp.listen(8877, "localhost", () => {\n  console.log("start");\n});\n')))}d.isMDXComponent=!0}}]);